{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-11T09:21:05.034Z",
  "summary": "Diff adds Privacy Policy support across backend types, a new PrivacyPolicyPage with scrollable display, a footer/navigation link, and extends the admin legal-docs panel to view/edit/save Privacy Policy and publish provided legal texts. However, the added migration appears to discard existing stored legal content, which conflicts with the requested upgrade preservation behavior, and backend API/access-control specifics for Privacy Policy are not evidenced in the provided diff excerpts.",
  "missing_requirements": [
    {
      "id": "REQ-23",
      "requirement": "Backend exposes a query method to fetch Privacy Policy content without requiring a Super Admin role, and a shared save/update method that traps when caller is not a Super Admin; existing Terms APIs continue unchanged.",
      "reason": "The diff shows new TermsType variants (#privacyPolicy) and types, but the actual backend methods (query fetch + restricted save behavior) are not shown in the truncated backend/main.mo excerpt or elsewhere in the diff summary, so implementation cannot be verified from the provided evidence.",
      "evidence": [
        "backend/main.mo"
      ]
    },
    {
      "id": "REQ-24",
      "requirement": "Upgrade path preserves existing legal content in stable state unless it is empty/unset (conditional migration policy if schema changes are required).",
      "reason": "The new migration run() returns an empty termsContent map and does not copy any old stored terms content; this would not preserve existing content during upgrade.",
      "evidence": [
        "backend/migration.mo"
      ]
    }
  ],
  "hallucinated_features": [
    {
      "description": "Migration that resets all legal document content to an empty map during upgrade.",
      "reason": "Not requested; conflicts with REQ-24â€™s requirement to preserve existing stable content unless empty/unset.",
      "evidence": [
        "backend/migration.mo"
      ]
    },
    {
      "description": "Admin UI action to 'Publish Provided Legal Docs' with confirmation dialog (bulk overwrite of all legal documents).",
      "reason": "REQ-24 requires publishing provided text, but does not explicitly request adding a bulk-publish button/flow that overwrites existing content; this is additional behavior beyond the stated requirements.",
      "evidence": [
        "frontend/src/components/admin/TermsManagementPanel.tsx"
      ]
    }
  ],
  "confidence": 0.72,
  "changed_files": [
    "backend/main.mo",
    "backend/migration.mo",
    "frontend-file-summaries.txt",
    "frontend/src/App.tsx",
    "frontend/src/components/admin/TermsManagementPanel.tsx",
    "frontend/src/components/layout/AppLayout.tsx",
    "frontend/src/legal/providedLegalText.ts",
    "frontend/src/pages/terms/PrivacyPolicyPage.tsx",
    "project_state.json"
  ]
}